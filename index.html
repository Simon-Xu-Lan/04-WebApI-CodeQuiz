<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code Quiz</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Roboto&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js" integrity="sha256-KzZiKy0DWYsnwMF+X1DvQngQ2/FxF7MF3Ff72XcpuPs=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  </head>
  <body>
    <!-- START OF NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand" href="index.html">Code Quiz</a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarTogglerDemo01"
          aria-controls="navbarTogglerDemo01"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
          <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="#">View All</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html">About</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- END OF NAVBAR -->

    <!-- START OF MAIN -->
    <main class="container text-center">
      <div class="row">
        <div class="col md-8">
          <div class="block" id="start-container">
            <h2 class="block-header">Challenge yourself and have fun!</h2>
            <p><span id="qty"></span> questions covering the basic of HTML, CSS, and Javascript</p>
            <button class="btn btn-primary" id="start-button">Start Quiz</button>
          </div>
          
          <!-- timer -->
          <div id="timer">
            <p>Time: <span id="minute"></span>:<span id="second"></span></p>
          </div>

          <div id="quiz-container">
            <h3>Question <span id="number1">2</span> of <span id="number2"></span></h3>
            <p id=question></p>
            <div class="answer-container">
              <input type="radio" id="input1" class="answer" name="choice" value="1">
              <label for="input1" id="label1" class="answer-label"></label><br>
              <input type="radio" id="input2" class="answer" name="choice" value="2">
              <label for="input2" id="label2" class="answer-label"></label><br>
              <input type="radio" id="input3" class="answer" name="choice" value="3">
              <label for="input3" id="label3" class="answer-label"></label><br>
              <input type="radio" id="input4" class="answer" name="choice" value="4">
              <label for="input4" id="label4" class="answer-label"></label><br>
            </div>
            
            <div id="answer-button-container">
              <button id="next-button">Next ></button>
            </div>  

            <!-- <input type="text" id="timer" value="02:03"> -->
          </div> <!-- end of quiz-container -->

          <!-- timer -->


          <div id="result-container">
            <h1>Result</h1>
            <P><span id="correctQty"></span> of <span id="totalQty"></span></P>
            <p>score: <span id="score"></span></p>
            <p id="comments"></p>
            <button  class="mybutton" id="review">Review your answers</button>
            <button  class="mybutton" id="again">Try Again</button>
          </div> <!--end of result-container-->

          <div id="review-container">
            <h1>Code Quiz Results</h1>
            <P><span id="correctQty"></span> of <span id="totalQty"></span></P>
            <p>score: <span id="score"></span></p>
            <!-- <p class="q-review" id="q1">A</p>
            <p class="q-review" id="q1">B</p>
            <p class="q-review" id="q1">C</p>
            <p class="q-review" id="q1">D</p> -->
            
          </div> 


        </div> <!--end of col-->
      </div> <!--end of row-->
    </main> <!--end of main-->


    <!-- START OF FOOTER -->
    <footer class="bg-dark">
      <div class="container">
        <div class="row">
          <!-- <div class="col text-center">
            <h2 class="text-white font-weight-light text-capitalize p-3">Profs Book Club</h2>   
            <div class="py-2">
              <a href="#">
                <i class='fas fa-book-open' style='font-size:48px'></i>
              </a>
            </div>  -->
            <p class="text-light py-4 m-0">
              &copy;Copyright 2020 - Made by Professor Greybeard
            </p>
          <!-- </div> -->
        </div>
      </div>
    </footer>
    <!-- END OF FOOTER -->
    <script> 
      // declare global variables
      // use object structure to store questions
      var quizObj = [
          {
              id: 1,
              question: "Choose the correct HTML element for the largest heading:",
              options: [
                "<h6>",
                "<h1>",
                "<heading>",
                "<head>",
              ],
              answer: "2",
              score: 10,
          },
          {
              id: 2,
              question: "What is the correct HTML element for inserting a line break?",
              options: [
                "<br>",
                "<lb>",
                "<break>",
                "<label>",
              ],
              answer: "1",
              score: 10,
          },
          {
              id: 3,
              question: "What is the correct HTML for creating a hyperlink?",
              options: [
                "<a>http://www.w3schools.com</a>",
                "<a href=\"http://www.w3schools.com\">W3Schools</a>",
                "<a name=\"http://www.w3schools.com\">W3Schools.com</a>",
                "<a url=\"http://www.w3schools.com\">W3Schools.com</a>",
              ],
              answer: "2",
              score: 20,
          },
          {
              id: 4,
              question: "What is the correct HTML for inserting an image?",
              options: [
                "<img href=\"image.gif\" alt=\"MyImage\">",
                "<image src=\"image.gif\" alt=\"MyImage\">",
                "<img src=\"image.gif\" alt=\"MyImage\">",
                "<img alt=\"MyImage\">image.gif</img>",
              ],
              answer: "3",
              score: 20,
          },
          {
              id: 5,
              question: "	What does CSS stand for?",
              options: [
                "Computer Style Sheets",
                "Colorful Style Sheets",
                "Cascading Style Sheets",
                "Creative Style Sheets",
              ],
              answer: "3",
              score: 15,
          },
          {
              id: 6,
              question: "Which is the correct CSS syntax?",
              options: [
                "{body;color:black;}",
                "body:color=black;",
                "{body:color=black;}",
                "body {color: black;}",
              ],
              answer: "4",
              score: 20,
          },
          {
              id: 7,
              question: "How do you display hyperlinks without an underline?",
              options: [
                "a {text-decoration:none;}",
                "a {text-decoration:no-underline;}",
                "a {underline:none;}",
                "a {decoration:no-underline;}",
              ],
              answer: "1",
              score: 20,
          },
          {
              id: 8,
              question: "Inside which HTML element do we put the JavaScript?",
              options: [
                "<javascript>",
                "<js>",
                "<script>",
                "<scripting>",
              ],
              answer: "3",
              score: 10,
          },
          {
              id: 9,
              question: "How do you write \"Hello World\" in an alert box?",
              options: [
              "alertBox(\"Hello World\");",
              "msgBox(\"Hello World\");",
              "msg(\"Hello World\");",
              "alert(\"Hello World\");",
              ],
              answer: "4",
              score: 20,
          },
          {
              id: 10,
              question: "What is the correct JavaScript syntax to change the content of the HTML element below? --- <p id=\"demo\">This is a demonstration.</p>",
              options: [
                "document.getElement(\"p\").innerHTML = \"Hello World!\";",
                "#demo.innerHTML = \"Hello World!\";",
                "document.getElementById(\"demo\").innerHTML = \"Hello World!\";",
                "document.getElementByName(\"p\").innerHTML = \"Hello World!\";",
              ],
              answer: "3",
              score: 30,
          },
          {
              id: 11,
              question: "How does a FOR loop start?",
              options: [
                "for (i <= 5; i++)",
                "for (i = 0; i <= 5)",
                "for (i = 0; i <= 5; i++)",
                "for i = 1 to 5",
              ],
              answer: "3",
              score: 30,
          },
          {
              id: 12,
              question: "What is the correct way to write a JavaScript array?",
              options: [
                'var colors = ["red", "green", "blue"]',
                'var colors = (1:"red", 2:"green", 3:"blue")',
                'var colors = "red", "green", "blue"',
                'var colors = 1 = ("red"), 2 = ("green"), 3 = ("blue")',
              ],
              answer: "1",
              score: 20,
          },
      ];
      var q = 0; // declare a global variable q to track questions
      var timer; // declare a global variable to store the return ID of setInterval
      var quizTime = 2; //declare a global variable to store the quiz time. we can change the quiz time here.
      var sec, min, totalSecond; //declare two global variables to store second adn minute in timer
      var cQty = 0; //declare a global variable `cQty` to store the quantity of question answered correctly
      var userScore = 0; //declare a global variable `userScore` to store the score
      var selectedAnswer = "No answer";
      var userAnswerArr =[]; //declare an array to track the user's answer
      //declare the following variable to store elements
      var startBtnEl = document.getElementById("start-button");
      var nextBtnEl = document.getElementById("next-button");
      var finishBtnEl = document.getElementById("finish");
      var radioConEls = document.getElementsByClassName("radio-container");
      var secondEl = document.getElementById("second"); //declare a global variable to remember second element
      var minuteEl = document.getElementById("minute"); ////declare a global variable to remember minute element


      //declare this function to display question and options
      function displayQuestion(i) {
          document.getElementById("number1").textContent = i + 1;
          document.getElementById("question").textContent = quizObj[i].question;
          document.getElementById("label1").textContent = quizObj[i].options[0];
          document.getElementById("label2").textContent = quizObj[i].options[1];
          document.getElementById("label3").textContent = quizObj[i].options[2];
          document.getElementById("label4").textContent = quizObj[i].options[3];
      };
      //declare this function to reset the check button 
      function resetAnswer() {
        document.getElementById("input1").checked = false;
        document.getElementById("input2").checked = false;
        document.getElementById("input3").checked = false;
        document.getElementById("input4").checked = false;
        selectedAnswer = "No answer";
      };

      //declare a function to reset timer
      function resetTimer(time) {
        sec = 0;
        min = quizTime;
        totalSecond = time*60;
  
        secondEl.textContent = "00";
        if (min >= 10) {
          minuteEl.textContent = " " + min;
        } else {
          minuteEl.textContent =" 0" + min;
        }

      };  

      //declare this function to start timer
      function startTimer() {
        timer = setInterval(() => {
          totalSecond -= 1;
            if (totalSecond < 0) {
                clearInterval(timer);
                //display result when time out
                document.getElementById("quiz-container").setAttribute("style", "display:none");
                document.getElementById("timer").setAttribute("style", "display: none");
                document.getElementById("result-container").setAttribute("style", "display:block");
            } else {
                if (sec <= 60 && sec > 0 && min >= 0) {
                    sec -= 1;
                    if (sec > 9) {
                        secondEl.innerHTML = sec;
                    } else {
                        secondEl.innerHTML = "0" + sec;
                    };
                } else if (sec === 0 && min >= 0) {
                    sec = 59;
                    min -= 1;
                    minuteEl.innerHTML = "0" + min;
                    secondEl.innerHTML = "" + sec;
                }; 
            }
        }, 1000);
      };
    
      //declare this function to stop timer
      function stopTimer() {
        clearInterval(timer);
      };

      //main program starts
      //set the qty of total questions
      document.getElementById("qty").innerHTML = ""+quizObj.length;
      document.getElementById("number2").textContent = quizObj.length;
      
      //set the initial value of timer
      resetTimer(quizTime);

      // start button to trigger timer and start the quiz
      startBtnEl.addEventListener("click", function() {
        //display timer and quiz container and hide star container
        document.getElementById("start-container").style.display = "none";
        document.getElementById("timer").style.display = "block"
        document.getElementById("quiz-container").style.display = "block";
        // start timer, the quiz time is 2 minutes
        startTimer();
        // display question
        displayQuestion(q);
      });

      //next button to display next question
      nextBtnEl.addEventListener("click", function() {
        if (selectedAnswer === quizObj[q].answer) {
          cQty++;
          userScore += quizObj[q].score;
          
        }
        userAnswerArr.push(selectedAnswer)
        
        resetAnswer();
        if (q<(quizObj.length-1)) {
            q++;
            displayQuestion(q);
        } else { //trigger finish button and make next button dispear once finish all questions
            document.getElementById("quiz-container").setAttribute("style", "display:none");
            document.getElementById("timer").setAttribute("style", "display: none");
            document.getElementById("result-container").setAttribute("style", "display:block");
            //stop the timer if finish the quiz before time out.
            stopTimer();
        };
      });

      //radio input click to trigger event
      Array.from(document.querySelectorAll(".answer")).forEach(item => {
        item.addEventListener("click", function() {
          // if(this.value === quizObj.answer) {
          //   cQty++;
          //   userScore += quizObj.score
          // };
          // userAnswer.push(this.value);
          // console.log(q,userAnswer);
          selectedAnswer = this.value;
        });
      });

      //set up the result page
      document.getElementById("correctQty").textContent = cQty;
      document.querySelector("#totalQty").textContent = quizObj.length;
      document.querySelector("#score").textContent ="" + userScore;

      var cmt = ""; //declare a global variable to store the comments on the result.
      // var percent; //declare a global variable to store the percentage of correct answer
      var fullScore = 0; //declare a global variable to store the full score of the quiz. 
      for(var i=0; i<quizObj.length; i++) { //calculate the full score of the quiz.
        fullScore += quizObj[i].score;
      };
      //display different comments according to the percent
      //declare a global variable to store the percentage of correct answer

      var percent = Math.ceil((userScore / fullScore)*5);
      switch (percent) {
        case 0:
        case 1:
        document.querySelector("#comments").textContent = "Well, you have a loft of studying to do!";
        break;
        case 2:
        document.querySelector("#comments").textContent = "You must study much harder!";
        break;
        case 3:
        document.querySelector("#comments").textContent = "You must study harder!";
        break;
        case 4:
        document.querySelector("#comments").textContent = "Almost! study a little more and take the test again!";
        break;
        case 5:
        document.querySelector("#comments").textContent = "You can be proud of yourself!";
        break;        
      };

      //Click the try again button to redo the quiz.
      document.getElementById("again").addEventListener("click", function() {
        document.getElementById("result-container").setAttribute("style", "display:none");
        document.getElementById("start-container").setAttribute("style", "display:block");
        q = 0;
        resetTimer(quizTime);
      });
      

      //Click the review button check your answers
      document.getElementById("review").addEventListener("click", function() {
        document.getElementById("result-container").setAttribute("style", "display:none");
        document.getElementById("review-container").setAttribute("style", "display:block");
        var reviewCon = document.getElementById("review-container");
        console.log(reviewCon);

        for(var i=0; i<quizObj.length; i++) {
          
          var h3El = document.createElement("h3");
          h3El.textContent = "Question " + quizObj[i].id;
          reviewCon.appendChild(h3El);
          h3El.setAttribute("style", "text-align:left; padding-top:20px");

          var pQuestionEl = document.createElement("p");
          pQuestionEl.textContent = quizObj[i].question;
          reviewCon.appendChild(pQuestionEl);
          pQuestionEl.setAttribute("style", "text-align: left");

          var yourAnswerEl = document.createElement("span");
          yourAnswerEl.textContent = "Your answer";
          yourAnswerEl.setAttribute("style", "float: right");
          var correctAnswerEl = document.createElement("span");
          correctAnswerEl.textContent = "Correct answer";
          correctAnswerEl.setAttribute("style", "float: right");


          for(var j=0; j<4; j++) {
            var name = "answer" + j + "El";
            var name = document.createElement("p");
            name.textContent = quizObj[i].options[j];
            reviewCon.appendChild(name);
            name.setAttribute("class", "q-review");

            if(((j+1)+"") === quizObj[i].answer) {
              name.setAttribute("class", "q-review-correct");
              if(userAnswerArr[i] === quizObj[i].answer) {
                name.appendChild(yourAnswerEl);
              } else {
                name.appendChild(correctAnswerEl);
              };
            } else if(((j+1)+"") === userAnswerArr[i]) {
              name.setAttribute("class", "q-review-wrong");
              name.appendChild(yourAnswerEl);
            };
          }; //end inside for loop
        }; //end outside for loop        
      }); //end the review click event function

    </script>

      
  </body>
</html>
